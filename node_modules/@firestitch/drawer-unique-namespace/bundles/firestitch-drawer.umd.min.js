!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/cdk/portal"),require("@angular/cdk/overlay"),require("@angular/material/button"),require("@angular/material/icon"),require("@angular/material/menu"),require("@angular/material/tooltip"),require("@firestitch/menu"),require("rxjs"),require("@angular/cdk/keycodes"),require("rxjs/operators"),require("@angular/cdk/layout")):"function"==typeof define&&define.amd?define("@firestitch/drawer",["exports","@angular/core","@angular/common","@angular/cdk/portal","@angular/cdk/overlay","@angular/material/button","@angular/material/icon","@angular/material/menu","@angular/material/tooltip","@firestitch/menu","rxjs","@angular/cdk/keycodes","rxjs/operators","@angular/cdk/layout"],t):t(((e=e||self).firestitch=e.firestitch||{},e.firestitch.drawer={}),e.ng.core,e.ng.common,e.ng.cdk.portal,e.ng.cdk.overlay,e.ng.material.button,e.ng.material.icon,e.ng.material.menu,e.ng.material.tooltip,e.menu$1,e.rxjs,e.ng.cdk.keycodes,e.rxjs.operators,e.ng.cdk.layout)}(this,(function(e,t,n,i,r,o,a,s,c,p,d,l,u,h){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function y(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var g,_=function(){return(_=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function m(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function b(e,t){return function(n,i){t(n,i,e)}}function v(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}(g=e.FsDrawerAction||(e.FsDrawerAction={})).Button="button",g.Menu="menu",g.Component="component";var R=function(){function e(e){void 0===e&&(e={}),this._visible=!0,this._icon=e.icon||"",this._click=e.click||null,this._link=e.link,this._show=e.show||null}return Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"click",{get:function(){return this._click},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"routerLink",{get:function(){return this._routerLink},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),e.prototype.checkVisibility=function(e){this._show&&(this._visible=this._show(e))},e.prototype.updateRouterLink=function(e){this._visible&&this._link&&(this._routerLink=this._link(e))},e}(),O=function(e){function t(n){void 0===n&&(n={});var i=e.call(this,n)||this;return i.actions=[],i._isGroup=!1,Array.isArray(n.actions)&&(i._isGroup=!0,i.actions=n.actions.map((function(e){return new t(e)}))),i._label=n.label||"",i}return y(t,e),Object.defineProperty(t.prototype,"isGroup",{get:function(){return this._isGroup},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t.prototype.updateRouterLink=function(t){e.prototype.updateRouterLink.call(this,t),this.actions.length>0&&this.actions.forEach((function(e){e.updateRouterLink(t)}))},t.prototype.checkVisibility=function(t){e.prototype.checkVisibility.call(this,t),this.actions.length>0&&this.actions.forEach((function(e){e.checkVisibility(t)})),this.actions.length>0&&(this._visible=this.actions.some((function(e){return e.visible})))},t}(R),k=function(t){function n(n){void 0===n&&(n={});var i=t.call(this,n)||this;return i._data=null,i._close=!1,i._closeSide=!0,i._menuActions=[],i._component=null,i._menuRefName=null,i._icon=n.icon||"",i._type=n.type||"",i._name=n.name||"",i._toggle=void 0===n.toggle||n.toggle,i._tooltip=n.tooltip||"",i._close=!!n.close,i._component=n.component||null,i._data=void 0===n.data?{}:n.data,i._type===e.FsDrawerAction.Component&&(i._menuRefName=n.name||n.icon),i._type===e.FsDrawerAction.Menu&&void 0===n.closeSide?i._closeSide=!1:i._closeSide=void 0===n.closeSide||!!n.closeSide,Array.isArray(n.actions)&&(i._menuActions=n.actions.map((function(e){return new O(e)}))),i}return y(n,t),Object.defineProperty(n.prototype,"icon",{get:function(){return this._icon},set:function(e){this._icon=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"toggle",{get:function(){return this._toggle},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tooltip",{get:function(){return this._tooltip},set:function(e){this._tooltip=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"close",{get:function(){return this._close},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"closeSide",{get:function(){return this._closeSide},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"menuActions",{get:function(){return this._menuActions},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"component",{get:function(){return this._component},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"menuRefName",{get:function(){return this._menuRefName},enumerable:!0,configurable:!0}),n.prototype.updateRouterLink=function(e){this._visible&&(t.prototype.updateRouterLink.call(this,e),this._menuActions.length>0&&this._menuActions.forEach((function(t){t.updateRouterLink(e)})))},n.prototype.checkVisibility=function(e){t.prototype.checkVisibility.call(this,e),this._menuActions.length>0&&this._menuActions.forEach((function(t){t.checkVisibility(e)})),this.menuActions.length>0&&(this._visible=this.menuActions.some((function(e){return e.visible})))},n}(R),S=function(e){void 0===e&&(e={}),this.disableClose=e.disableClose||!1,this.position=e.position||"right",this.activeAction=e.activeAction||"",this.resizable=void 0===e.resizable||e.resizable,e.width&&(this.width=e.width),this.actions=e.actions&&e.actions.map((function(e){return new k(e)}))||null},A=function(){function e(e,t,n){this._overlayRef=e,this._dataFactory=t,this._afterOpened$=new d.Subject,this._afterClosed$=new d.Subject,this._closeStart$=new d.Subject,this._openStart$=new d.Subject,this._sideToggle=new d.Subject,this._actionsUpdated$=new d.Subject,this._destroy$=new d.Subject,this._activeAction=new d.BehaviorSubject(void 0),this._menuRefs=new Map,this._isOpen=!1,this._isSideOpen=!1,this.drawerConfig=new S(n),this._activeAction.next(this.drawerConfig.activeAction)}return Object.defineProperty(e.prototype,"overlayRef",{get:function(){return this._overlayRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drawerData",{get:function(){return _({},this._dataFactory.getValue())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destroy$",{get:function(){return this._destroy$.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerRef",{set:function(e){this._drawerContainerRef=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentRef",{set:function(e){this._drawerComponentRef=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drawerContentContainer",{get:function(){return this._drawerContentContainer},set:function(e){this._drawerContentContainer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drawerActionsContainer",{get:function(){return this._drawerActionsContainer},set:function(e){this._drawerActionsContainer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeAction",{get:function(){return this._activeAction.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeAction$",{get:function(){return this._activeAction.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSideOpen",{get:function(){return this._isSideOpen},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeController",{get:function(){return this._resizeController},set:function(e){this._resizeController=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionUpdated$",{get:function(){return this._actionsUpdated$.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterClosed$",{get:function(){return this._afterClosed$.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterOpened$",{get:function(){return this._afterOpened$.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openStart$",{get:function(){return this._openStart$.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closeStart$",{get:function(){return this._closeStart$.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataChanged$",{get:function(){return this._dataFactory.dataChange$},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sideToggle$",{get:function(){return this._sideToggle.pipe(u.takeUntil(this._destroy$))},enumerable:!0,configurable:!0}),e.prototype.events=function(){var e=this;this._overlayRef.keydownEvents().pipe(u.filter((function(t){return t.keyCode===l.ESCAPE&&!e.drawerConfig.disableClose})),u.takeUntil(this._destroy$)).subscribe((function(){return e.close()}))},e.prototype.dataChange=function(e){this._dataFactory.setValue(e)},e.prototype.open=function(){var e=this;new d.Observable((function(t){setTimeout((function(){e._openStart$.observers.length?e._openStart$.next(t):(t.next(),t.complete())}))})).pipe(u.takeUntil(this._destroy$)).subscribe({next:function(){e.activeAction&&e.openSide(),e._drawerContainerRef.open(),e._afterOpened$.next(),e._afterOpened$.complete()},error:function(){e.destroy()}})},e.prototype.close=function(e){var t=this;new d.Observable((function(e){t._closeStart$.observers.length?d.zip.apply(void 0,C(t._closeStart$.observers.map((function(e){return d.Observable.create((function(t){e.next(t)}))})))).pipe(u.takeUntil(t._destroy$)).subscribe((function(){e.next(),e.complete()}),(function(){e.error()})):(e.next(),e.complete())})).pipe(u.takeUntil(this._destroy$)).subscribe({next:function(){t._drawerContainerRef.close(),t._result=e,t._afterClosed$.next(e),t.destroy()}})},e.prototype.openSide=function(){this._isSideOpen=!0,this._sideToggle.next(this._isSideOpen)},e.prototype.closeSide=function(){this._isSideOpen=!1,this._sideToggle.next(this._isSideOpen),this.setActiveAction(null)},e.prototype.toggleSide=function(){this.isSideOpen?this.closeSide():this.openSide()},e.prototype.setActiveAction=function(e){this._activeAction.next(e),e&&this.openSide()},e.prototype.addMenuRef=function(e,t){var n=this;this._menuRefs.set(e,t),t.afterClosed().pipe(u.take(1),u.takeUntil(this._destroy$)).subscribe((function(){n._menuRefs.delete(e)}))},e.prototype.getMenuRef=function(e){return this._menuRefs.get(e)},e.prototype.getAction=function(e){return this.drawerConfig.actions.find((function(t){return t.name===e}))},e.prototype.updateActionIcon=function(e,t){var n=this.getAction(e);n&&(n.icon=t,this._actionsUpdated$.next(e))},e.prototype.updateAction=function(e,t){var n=this.getAction(e);if(n){var i=["icon","type","toggle","tooltip","close","closeSide","component","data"];Object.keys(t).filter((function(e){return i.indexOf(e)>-1})).forEach((function(e){n[e]=t[e]})),this._actionsUpdated$.next(e)}},e.prototype.updateDrawerWidth=function(e){this.resizeController.updateMainWidth(e)},e.prototype.updateSideDrawerWidth=function(e){this.resizeController.updateSideWidth(e)},e.prototype.destroy=function(){this._overlayRef.detachBackdrop(),this._overlayRef.detach(),this._drawerComponentRef.destroy(),this._dataFactory.destroy(),this._destroy$.next(),this._destroy$.complete()},e}(),j=function(e){function n(){return e.call(this)||this}return y(n,e),n.prototype.setDrawerMenuRef=function(e){this.ref=e},n.prototype.attachComponentPortal=function(e){if(this._portalOutlet.hasAttached())throw Error("Drawer component already attached");return this._portalOutlet.attachComponentPortal(e)},n.prototype.attachTemplatePortal=function(e){if(this._portalOutlet.hasAttached())throw Error("Drawer template already attached");return this._portalOutlet.attachTemplatePortal(e)},m([t.ViewChild(i.CdkPortalOutlet,{static:!0}),v("design:type",i.CdkPortalOutlet)],n.prototype,"_portalOutlet",void 0),n=m([t.Component({selector:"fs-drawer-menu",template:"<ng-template cdkPortalOutlet></ng-template>\n",host:{class:"mat-elevation-z2"},changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[":host{padding:15px;background:#fff;border-radius:2px;overflow:auto}"]}),v("design:paramtypes",[])],n)}(i.BasePortalOutlet),P=function(){function e(e,t){var n=this;this._overlayRef=e,this._dataFactory=t,this._afterClosed$=new d.Subject,this._closeStart$=new d.Subject,this._destroy$=new d.Subject,this._overlayRef.backdropClick().pipe(u.takeUntil(this._destroy$)).subscribe((function(){n.close()}))}return Object.defineProperty(e.prototype,"menuData",{get:function(){return _({},this._dataFactory.getValue())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerRef",{set:function(e){this._externalMenuContainerRef=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentRef",{set:function(e){this._externalMenuComponentRef=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataChanged$",{get:function(){return this._dataFactory.dataChange$},enumerable:!0,configurable:!0}),e.prototype.dataChange=function(e){this._dataFactory.setValue(e)},e.prototype.afterClosed=function(){return this._afterClosed$.pipe(u.takeUntil(this._destroy$))},e.prototype.closeStart=function(){return this._closeStart$.pipe(u.takeUntil(this._destroy$))},e.prototype.close=function(e){var t=this;new d.Observable((function(e){t._closeStart$.observers.length?d.zip.apply(void 0,C(t._closeStart$.observers.map((function(e){return d.Observable.create((function(t){e.next(t)}))})))).pipe(u.takeUntil(t._destroy$)).subscribe((function(){e.next(),e.complete()}),(function(){e.error()})):(e.next(),e.complete())})).pipe(u.takeUntil(this._destroy$)).subscribe({next:function(){t._result=e,t._afterClosed$.next(e),t.destroy()}})},e.prototype.destroy=function(){this._overlayRef.detachBackdrop(),this._overlayRef.detach(),this._externalMenuComponentRef&&this._externalMenuComponentRef.destroy(),this._dataFactory.destroy(),this._destroy$.next(),this._destroy$.complete()},e}(),$=function(){function e(e){void 0===e&&(e={}),this._dataChange=new d.Subject,this._destroy=new d.Subject,this._data=e}return e.createWithProxy=function(t){void 0===t&&(t={});var n=new e(t);return new Proxy(n,{get:function(e,t){return"function"==typeof e[t]||"_data"===t||e[t]instanceof d.Observable?e[t]:e._data[t]},set:function(e,t,n){return"_data"!==t?e._data[t]=n:e[t]=n,!0},has:function(e,t){return t in e._data},ownKeys:function(e){return Object.keys(e._data)},enumerate:function(e){return Object.keys(e._data)},getOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e._data,t)}})},Object.defineProperty(e.prototype,"dataChange$",{get:function(){return this._dataChange.pipe(u.takeUntil(this._destroy))},enumerable:!0,configurable:!0}),e.prototype.getValue=function(){return this._data},e.prototype.setValue=function(e){this._data=e,this._dataChange.next(this._data)},e.prototype.destroy=function(){this._destroy.next(),this._destroy.complete()},e}(),D=new t.InjectionToken("fs.drawer.menu-data"),E=function(){function e(e,t,n){this._overlay=e,this._injector=t,this._breakpointObserver=n}return e.prototype.create=function(e,t,n){var i=this.createOverlay(t),r=$.createWithProxy(n.data),o=new P(i,r),a=this.attachContainer(i,o,r),s=this.attachComponent(e,a,o,r);return o.containerRef=a,a.setDrawerMenuRef(o),o.componentRef=s,o},e.prototype.createOverlay=function(e){var t=this.getOverlayConfig(e);return this._overlay.create(t)},e.prototype.getOverlayConfig=function(e){var n=new t.ElementRef(e),i=null;if(this._breakpointObserver.isMatched(h.Breakpoints.XSmall))i=this._overlay.position().global().centerHorizontally().centerVertically();else{i=this._overlay.position().flexibleConnectedTo(n).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}return new r.OverlayConfig({positionStrategy:i,scrollStrategy:this._overlay.scrollStrategies.reposition(),hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop"})},e.prototype.attachContainer=function(e,t,n){var r=this.createInjector(t,n),o=new i.ComponentPortal(j,void 0,r);return e.attach(o).instance},e.prototype.attachComponent=function(e,t,n,r){var o=this.createInjector(n,r);return t.attachComponentPortal(new i.ComponentPortal(e,void 0,o))},e.prototype.createInjector=function(e,t){var n=new WeakMap([[P,e],[D,t]]);return new i.PortalInjector(this._injector,n)},e.ctorParameters=function(){return[{type:r.Overlay},{type:t.Injector},{type:h.BreakpointObserver}]},e=m([t.Injectable(),v("design:paramtypes",[r.Overlay,t.Injector,h.BreakpointObserver])],e)}(),x=function(){function n(e,t,n){this._drawerRef=e,this._drawerMenu=t,this._cdRef=n,this._destroy$=new d.Subject}return n.prototype.ngOnInit=function(){},n.prototype.ngOnDestroy=function(){this._destroy$.next(),this._destroy$.complete()},n.prototype.actionClick=function(t,n){var i=t.type===e.FsDrawerAction.Component,r=t.type===e.FsDrawerAction.Menu;if(i){var o=this._drawerMenu.create(t.component,n.srcElement,t);this._drawerRef.addMenuRef(t.menuRefName,o);var a={event:n,action:t,drawerRef:this._drawerRef,menuRef:o};t.click.call(null,a),t.closeSide&&this._drawerRef.closeSide()}else if(t.click){a={event:n,action:t};t.click.call(null,a)}t.close&&this._drawerRef.close(),t.toggle&&(!i&&!r||t.closeSide)&&(this._drawerRef.isSideOpen&&this._drawerRef.activeAction===t.name?this._drawerRef.toggleSide():this._drawerRef.setActiveAction(t.name))},n.ctorParameters=function(){return[{type:A},{type:E},{type:t.ChangeDetectorRef}]},m([t.Input(),v("design:type",Array)],n.prototype,"actions",void 0),m([t.Input(),v("design:type",String)],n.prototype,"activeAction",void 0),n=m([t.Component({selector:"fs-drawer-actions",template:'<div class="actions-container">\n  <div *ngFor="let action of actions" class="action-btn">\n    <fs-drawer-action-item [action]="action"\n                           [activeAction]="activeAction"\n                           (actionClicked)="actionClick(action, $event)">\n    </fs-drawer-action-item>\n  </div>\n</div>\n\n<div class="drag-icon">\n  <a mat-icon-button class="resize-icon"><mat-icon>drag_indicator</mat-icon></a>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[":host{display:flex}.actions-container{flex:0}.drag-icon{display:flex;flex:1;align-items:center}"]}),v("design:paramtypes",[A,E,t.ChangeDetectorRef])],n)}(),z=function(){function e(e,t){this._drawerRef=e,this._ngZone=t,this._sideOpened=!1,this._borderPadding=0,this._destroy$=new d.Subject,this._initDefaultConfigs(),this._updateScreenWidth(),this._listenWindowResize(),this._listenSideToggle()}return Object.defineProperty(e.prototype,"mainElRef",{get:function(){return this._mainElRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sideElRef",{get:function(){return this._sideElRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainConfig",{get:function(){return this._mainConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sideConfig",{get:function(){return this._sideConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"screenWidth",{get:function(){return this._screenWidth},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this._destroy$.next(),this._destroy$.complete()},e.prototype.registerElRef=function(e){if("main"===e.type)this._registerMainRef(e);else{if("side"!==e.type)throw Error("Unrecognized resize element type");this._registerSideRef(e)}},e.prototype.getInitialWidth=function(e){return"main"===e?this.mainConfig.initial:"side"===e?this.sideConfig.initial:void 0},e.prototype.getMinWidth=function(e){return"main"===e?this.mainConfig.min:"side"===e?this.sideConfig.min:void 0},e.prototype.getMaxWidth=function(e){return"main"===e?this.mainConfig.max:"side"===e?this.sideConfig.max:void 0},e.prototype.updateMainWidth=function(e){var t=this.sideElRef&&this.sideElRef.width||0;this.mainElRef.updateWidth(t+e)},e.prototype.updateSideWidth=function(e){if(this.sideElRef){var t=this.mainElRef.width-this.sideElRef.width;this.mainElRef.updateWidth(t+e),this.sideElRef.updateWidth(e)}},e.prototype.pushMainWidth=function(e){var t=e.resizeController.mainElRef.width+40;this.mainElRef.width<=t&&this.updateMainWidth(t)},e.prototype._listenWindowResize=function(){var e=this;this._ngZone.runOutsideAngular((function(){d.fromEvent(window,"resize").pipe(u.debounceTime(50),u.takeUntil(e._destroy$)).subscribe((function(){e._updateScreenWidth(),e._updateMinMaxStyles()}))}))},e.prototype._initDefaultConfigs=function(){this._mainConfig=this._drawerRef.drawerConfig.width&&this._drawerRef.drawerConfig.width.main||{},this._mainConfig.initial=this._mainConfig.initial||500,this._sideConfig=this._drawerRef.drawerConfig.width&&this._drawerRef.drawerConfig.width.side||{},this._sideConfig.initial=this._sideConfig.initial||200},e.prototype._registerMainRef=function(e){this._mainElRef=e},e.prototype._registerSideRef=function(e){this._sideElRef=e},e.prototype._updateScreenWidth=function(){this._screenWidth=window.innerWidth-this._borderPadding},e.prototype._updateMinMaxStyles=function(){this.mainElRef.setMinMaxStyles(),this.sideElRef&&this.sideElRef.setMinMaxStyles()},e.prototype._listenSideToggle=function(){var e=this;this._drawerRef.sideToggle$.pipe(u.takeUntil(this._destroy$)).subscribe((function(t){if(e._sideOpened!==t)if(e._sideOpened=t,t){var n=e.mainElRef.width,i=e.getInitialWidth("side");e._mainElRef.updateWidth(n+i+25)}else{var r=e.sideElRef.fsDrawerResizer.getBoundingClientRect().width,o=e.mainElRef.width-r-25;e._mainElRef.updateWidth(o)}}))},e.ctorParameters=function(){return[{type:A},{type:t.NgZone}]},e=m([t.Injectable(),v("design:paramtypes",[A,t.NgZone])],e)}(),M=function(e){function n(t,n,i,r,o){var a=e.call(this)||this;return a._el=t,a._drawerMenu=n,a._drawerRef=i,a._cdRef=r,a._resizeController=o,a.isOpen=!1,a.isOpenSide=!1,a.initialized=!1,a._sideOpen=!1,a._destroy$=new d.Subject,a._drawerRef.resizeController=a._resizeController,a}return y(n,e),Object.defineProperty(n.prototype,"sideOpen",{get:function(){return this._sideOpen},set:function(e){this._sideOpen=e,this._el.nativeElement.classList.toggle("side-open",this.sideOpen)},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){this._listenDataChanges()},n.prototype.ngOnDestroy=function(){this._destroy$.next(),this._destroy$.complete()},n.prototype.open=function(){this.isOpen=!0},n.prototype.close=function(){this.isOpen=!1},n.prototype.openSide=function(){this.isOpenSide=!0},n.prototype.closeSide=function(){this.isOpenSide=!1},n.prototype.setDrawerRef=function(e){var t=this;this.drawerRef=e,this.config=this.drawerRef.drawerConfig,this.drawerRef.drawerContentContainer=this._drawerContentContainer,this.drawerRef.drawerActionsContainer=this._drawerActionsContainer,this.drawerRef.sideToggle$.pipe(u.takeUntil(this._destroy$)).subscribe((function(e){t.sideOpen=e})),this.initialized=!0},n.prototype.attachComponentPortal=function(e){if(this._portalOutlet.hasAttached())throw Error("Drawer component already attached");return this._portalOutlet.attachComponentPortal(e)},n.prototype.attachTemplatePortal=function(e){if(this._portalOutlet.hasAttached())throw Error("Drawer template already attached");return this._portalOutlet.attachTemplatePortal(e)},n.prototype._listenDataChanges=function(){var e=this;this._drawerRef.dataChanged$.pipe(u.takeUntil(this._destroy$)).subscribe((function(){e._cdRef.detectChanges()}))},n.ctorParameters=function(){return[{type:t.ElementRef},{type:E},{type:A},{type:t.ChangeDetectorRef},{type:z}]},m([t.ViewChild(i.CdkPortalOutlet,{static:!0}),v("design:type",i.CdkPortalOutlet)],n.prototype,"_portalOutlet",void 0),m([t.ViewChild("drawerContentContainer",{static:!0}),v("design:type",t.ElementRef)],n.prototype,"_drawerContentContainer",void 0),m([t.ViewChild("drawerActionsContainer",{read:t.ElementRef,static:!0}),v("design:type",t.ElementRef)],n.prototype,"_drawerActionsContainer",void 0),n=m([t.Component({selector:"fs-drawer",template:'<div class="mat-elevation-z2 drawer" #drawer\n     hidden\n     [ngClass]="config.position"\n     [hidden]="!initialized">\n  <ng-container>\n    <fs-drawer-actions class="drawer-actions"\n                       #drawerActionsContainer\n                       type="main"\n                       [fsDrawerResizer]="drawer"\n                       [resizable]="drawerRef.drawerConfig.resizable"\n                       [sizeController]="drawerRef.resizeController"\n                       [direction]="config.position"\n                       [actions]="config.actions"\n                       [activeAction]="drawerRef.activeAction$ | async">\n    </fs-drawer-actions>\n    <div class="drawer-container" #drawerContentContainer>\n      <ng-template cdkPortalOutlet></ng-template>\n    </div>\n  </ng-container>\n</div>\n',providers:[E,z],host:{class:"fs-drawer-container"},encapsulation:t.ViewEncapsulation.None,changeDetection:t.ChangeDetectionStrategy.OnPush}),v("design:paramtypes",[t.ElementRef,E,A,t.ChangeDetectorRef,z])],n)}(i.BasePortalOutlet),W=function(){function e(){}return m([t.Input("fsDrawerAction"),v("design:type",String)],e.prototype,"name",void 0),e=m([t.Directive({selector:"[fsDrawerAction]"})],e)}(),I=function(){function e(e,n,i){this._cdRef=e,this._renderer=n,this._elRef=i,this.classSide=!0,this.activeTemplate=null,this._hidden=!1,this._destroy$=new t.EventEmitter}return Object.defineProperty(e.prototype,"hidden",{set:function(e){this._hidden=e,this._hidden?this._renderer.setAttribute(this._elRef.nativeElement,"hidden","true"):this._renderer.removeAttribute(this._elRef.nativeElement,"hidden")},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.hidden=!0,this.drawer||console.error('Drawer reference is null for @Input("fsDrawerSide")'),this._subscribeToActionChanges()},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout((function(){e.drawer&&(e.hidden=!e.drawer.isSideOpen),e._updateActiveActionTemplate()}))},e.prototype.ngOnDestroy=function(){this._destroy$.emit(),this._destroy$.complete()},e.prototype._subscribeToActionChanges=function(){var e=this;this.drawer&&this.drawer.sideToggle$.pipe(u.takeUntil(this._destroy$)).subscribe((function(){e.hidden=!e.drawer.isSideOpen,e._updateActiveActionTemplate(),e._cdRef.detectChanges()}))},e.prototype._updateActiveActionTemplate=function(){if(this.drawer){var e=this.drawer.activeAction;if(this.drawer.isSideOpen&&e){var t=this.actions.toArray().findIndex((function(t){return t.name===e}));this.activeTemplate=this.actionsTemplates.toArray()[t]}else this.activeTemplate=null}},e.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:t.Renderer2},{type:t.ElementRef}]},m([t.Input("fsDrawerSide"),v("design:type",A)],e.prototype,"drawer",void 0),m([t.HostBinding("class.side"),v("design:type",Object)],e.prototype,"classSide",void 0),m([t.ContentChildren(W),v("design:type",t.QueryList)],e.prototype,"actions",void 0),m([t.ContentChildren(W,{read:t.TemplateRef}),v("design:type",t.QueryList)],e.prototype,"actionsTemplates",void 0),e=m([t.Component({selector:"[fsDrawerSide]",template:'<ng-container [ngSwitch]="drawer.drawerConfig.position" *ngIf="activeTemplate">\n  <ng-container *ngSwitchCase="\'right\'">\n    <div class="side-container" #sideContainer>\n      <div class="side-content">\n        <ng-template [ngTemplateOutlet]="activeTemplate"></ng-template>\n      </div>\n    </div>\n    <div class="resize-side"\n         resizable="true"\n         direction="left"\n         type="side"\n         [fsDrawerResizer]="sideContainer"\n         [resizable]="drawer.drawerConfig.resizable"\n         [sizeController]="drawer.resizeController"\n         [parentContainer]="drawer.drawerContentContainer"\n         [actionsContainer]="drawer.drawerActionsContainer"\n    >\n      <a mat-icon-button class="resize-icon"><mat-icon>drag_indicator</mat-icon></a>\n    </div>\n  </ng-container>\n  <ng-container *ngSwitchCase="\'left\'">\n    <div class="resize-side"\n         resizable="true"\n         direction="right"\n         [fsDrawerResizer]="sideContainer"\n    >\n    <a mat-icon-button class="resize-icon"><mat-icon>drag_indicator</mat-icon></a>\n    </div>\n    <div class="side-container" #sideContainer>\n      <div class="side-content">\n        <ng-template [ngTemplateOutlet]="activeTemplate"></ng-template>\n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[".resize-icon{width:24px;height:24px;line-height:24px}.resize-icon span{width:24px}"]}),v("design:paramtypes",[t.ChangeDetectorRef,t.Renderer2,t.ElementRef])],e)}(),T=function(){function n(n,i){this.drawer=n,this._cdRef=i,this.actionClicked=new t.EventEmitter,this.isActive=!1,this.actionTypes=e.FsDrawerAction,this._destroy$=new d.Subject,this._listenActionChanges(),this._listenDataChanges()}return n.prototype.ngOnInit=function(){this._updateVisibilityAndLinks()},n.prototype.ngOnChanges=function(e){e.activeAction&&(this.isActive=""!==this.action.name&&this.action.name===this.activeAction)},n.prototype.actionClick=function(e){this.actionClicked.emit(e)},n.prototype.menuActionClick=function(e,t){e.click&&e.click.call(null,{data:this.drawer.drawerData,event:t,drawerRef:this.drawer,action:e})},n.prototype._listenActionChanges=function(){var e=this;this.drawer.actionUpdated$.pipe(u.filter((function(t){return t===e.action.name})),u.takeUntil(this._destroy$)).subscribe((function(){e._cdRef.detectChanges()}))},n.prototype._listenDataChanges=function(){var e=this;this.drawer.dataChanged$.pipe(u.takeUntil(this._destroy$),u.debounceTime(50)).subscribe((function(){e._updateVisibilityAndLinks()}))},n.prototype._updateVisibilityAndLinks=function(){this._updateVisibility(),this._updateRouterLinks(),this._cdRef.detectChanges()},n.prototype._updateVisibility=function(){this.action.checkVisibility(this.drawer.drawerData)},n.prototype._updateRouterLinks=function(){this.action.type===this.actionTypes.Menu&&this.action.updateRouterLink({data:this.drawer.drawerData,drawerRef:this.drawer})},n.ctorParameters=function(){return[{type:A},{type:t.ChangeDetectorRef}]},m([t.Input(),v("design:type",k)],n.prototype,"action",void 0),m([t.Input(),v("design:type",String)],n.prototype,"activeAction",void 0),m([t.Output(),v("design:type",Object)],n.prototype,"actionClicked",void 0),n=m([t.Component({selector:"fs-drawer-action-item",template:'<ng-container [ngSwitch]="action.type">\n  <ng-container *ngSwitchCase="actionTypes.Button">\n    <button mat-icon-button\n            type="button"\n            *ngIf="action.visible"\n            [matTooltip]="action.tooltip"\n            [class.active]="isActive"\n            (click)="actionClick($event)">\n      <i class="material-icons">{{action.icon}}</i>\n    </button>\n  </ng-container>\n\n  <ng-container *ngSwitchCase="actionTypes.Menu">\n    <ng-container *ngIf="action.visible">\n      <button mat-icon-button\n              type="button"\n              class="sub-action"\n              [fsMenuTriggerFor]="menu"\n              [matTooltip]="action.tooltip"\n              [class.active]="isActive"\n              (click)="actionClick($event)">\n        <i class="material-icons">{{action.icon}}</i>\n      </button>\n\n      <fs-menu #menu>\n        <ng-container *ngFor="let menuAction of action.menuActions">\n          <ng-container *ngIf="menuAction.isGroup else simpleMenuItem">\n            <fs-menu-group [label]="menuAction.label" [hidden]="!menuAction.visible">\n              <ng-container *ngFor="let groupAction of menuAction.actions">\n                <ng-template fs-menu-item\n                             [hidden]="!groupAction.visible"\n                             [link]="groupAction.routerLink?.link"\n                             [queryParams]="groupAction.routerLink?.queryParams"\n                             (click)="menuActionClick(groupAction, $event);">\n                  <mat-icon *ngIf="menuAction.icon">{{groupAction.icon}}</mat-icon>\n                  {{groupAction.label}}\n                </ng-template>\n              </ng-container>\n            </fs-menu-group>\n          </ng-container>\n          <ng-template #simpleMenuItem>\n            <ng-template fs-menu-item\n                         [hidden]="!menuAction.visible"\n                         [link]="menuAction.routerLink?.link"\n                         [queryParams]="menuAction.routerLink?.queryParams"\n                         (click)="menuActionClick(menuAction, $event);">\n              <i class="material-icons" *ngIf="menuAction.icon">{{menuAction.icon}}</i>\n              <span>{{menuAction.label}}</span>\n            </ng-template>\n          </ng-template>\n        </ng-container>\n      </fs-menu>\n    </ng-container>\n  </ng-container>\n\n  <ng-container *ngSwitchCase="actionTypes.Component">\n    <button mat-icon-button\n            type="button"\n            *ngIf="action.visible"\n            [matTooltip]="action.tooltip"\n            [class.active]="isActive"\n            (click)="actionClick($event)">\n      <i class="material-icons">{{action.icon}}</i>\n    </button>\n  </ng-container>\n</ng-container>\n',changeDetection:t.ChangeDetectionStrategy.OnPush}),v("design:paramtypes",[A,t.ChangeDetectorRef])],n)}(),L=function(){function e(){}return e=m([t.Component({selector:"[fsDrawerContent]",template:'<div class="content"><ng-content></ng-content></div>',host:{class:"content-container"}})],e)}(),U=function(){function e(e,t,n){this._el=e,this._renderer=t,this._ngZone=n,this.fsDrawerResizer=this._el.nativeElement,this.direction="left",this.resizable=!0,this._dragStartHandler=this._dragStart.bind(this),this._dragHandler=this._drag.bind(this),this._dragEndHandler=this._dragEnd.bind(this),this._x=0,this._width=0,this._actionsWidth=0,this._destroy$=new d.Subject}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){var e=this.sizeController.getMinWidth(this.type);if(e&&e>=0)return e>this.sizeController.screenWidth?this.sizeController.screenWidth:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){var e=this.sizeController.getMaxWidth(this.type),t=null;return this.parentContainer&&(t=this._getElementWidth(this.parentContainer.nativeElement)),null!==t?!e||e>=t?t-2*this._actionsWidth:e:!e||e>=this.sizeController.screenWidth?this.sizeController.screenWidth:e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;if(this.sizeController.registerElRef(this),this.resizable){this._ngZone.runOutsideAngular((function(){e._el.nativeElement.addEventListener("mousedown",e._dragStartHandler,!1),e._el.nativeElement.addEventListener("touchstart",e._dragStartHandler,!1)})),this.actionsContainer&&(this._actionsWidth=this._getElementWidth(this.actionsContainer.nativeElement)),this.setMinMaxStyles();var t=this.sizeController.getMinWidth(this.type),n=this.sizeController.getInitialWidth(this.type)||this._getElementWidth(this.fsDrawerResizer);n<t&&(n=t),this.updateWidth(n)}},e.prototype.updateWidth=function(e){var t=this;this._width=e,requestAnimationFrame((function(){t._renderer.setStyle(t.fsDrawerResizer,"width",e+"px")}))},e.prototype.ngOnDestroy=function(){this._el.nativeElement.removeEventListener("mousedown",this._dragStartHandler,!1),this._el.nativeElement.removeEventListener("touchstart",this._dragStartHandler,!1),this._destroy$.next(),this._destroy$.complete()},e.prototype.setMinMaxStyles=function(){var e=this;requestAnimationFrame((function(){e._renderer.setStyle(e.fsDrawerResizer,"min-width",e.minWidth+"px"),e._renderer.setStyle(e.fsDrawerResizer,"max-width",e.maxWidth+"px")}))},e.prototype._dragStart=function(e){this._x=this._getClientX(e),this._width=this._getElementWidth(this.fsDrawerResizer),this.setMinMaxStyles(),document.addEventListener("touchmove",this._dragHandler,!1),document.addEventListener("touchend",this._dragEndHandler,!1),document.addEventListener("mousemove",this._dragHandler,!1),document.addEventListener("mouseup",this._dragEndHandler,!1)},e.prototype._drag=function(e){var t=this._getClientX(e),n=this._calcWidth(this.direction,t);this._updatePosition(t,n),this._emitResizeEvent()},e.prototype._dragEnd=function(e){document.removeEventListener("mousemove",this._dragHandler,!1),document.removeEventListener("mouseup",this._dragEndHandler,!1),document.removeEventListener("touchmove",this._dragHandler,!1),document.removeEventListener("touchend",this._dragEndHandler,!1)},e.prototype._getClientX=function(e){return e.touches?e.touches[0].clientX:e.clientX},e.prototype._getElementWidth=function(e){return e.getBoundingClientRect().width},e.prototype._updatePosition=function(e,t){this._x=e,this.updateWidth(t<0?0:t)},e.prototype._calcWidth=function(e,t){var n="left"===e?-1:1;return this._width+(this._x-t)*n},e.prototype._emitResizeEvent=function(){var e=window.document.createEvent("UIEvents");e.initEvent("resize",!0,!1),window.dispatchEvent(e)},e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:t.NgZone}]},m([t.Input(),v("design:type",Object)],e.prototype,"fsDrawerResizer",void 0),m([t.Input(),v("design:type",String)],e.prototype,"type",void 0),m([t.Input(),v("design:type",Object)],e.prototype,"direction",void 0),m([t.Input(),v("design:type",Object)],e.prototype,"resizable",void 0),m([t.Input(),v("design:type",t.ElementRef)],e.prototype,"parentContainer",void 0),m([t.Input(),v("design:type",t.ElementRef)],e.prototype,"actionsContainer",void 0),m([t.Input(),v("design:type",z)],e.prototype,"sizeController",void 0),e=m([t.Directive({selector:"[fsDrawerResizer]",host:{"[style.cursor]":'"col-resize"'}}),v("design:paramtypes",[t.ElementRef,t.Renderer2,t.NgZone])],e)}(),F=new t.InjectionToken("DrawerData"),V=function(){function e(e,t,n){this._parentDrawerService=e,this._overlay=t,this._injector=n,this._drawerRefs=new Set,this._destroy$=new d.Subject}return e.prototype.ngOnDestroy=function(){this._destroy$.next(),this._destroy$.complete()},e.prototype.open=function(e,t){var n=this,i=this._createOverlay(),r=$.createWithProxy(t.data),o=new A(i,r,t),a=this._attachDrawerContainer(i,o,r),s=this._attachComponent(e,a,o,r);return o.containerRef=a,a.setDrawerRef(o),o.componentRef=s,o.events(),o.open(),this._storeDrawerRef(o),d.merge(o.afterOpened$,o.afterClosed$).pipe(u.takeUntil(this._destroy$)).subscribe((function(){setTimeout((function(){n._applyBackdrop(),n._applyBodyOpenClass()}))})),o},e.prototype.closeAll=function(){this._drawerRefs.forEach((function(e){return e.close()})),this._parentDrawerService&&this._parentDrawerService.closeAll()},e.prototype._applyBackdrop=function(){var e=this;Array.from(this._drawerRefs).forEach((function(t,n){var i=t.overlayRef.backdropElement;i&&(n&&n===e._drawerRefs.size-1?i.classList.add("fs-drawer-backdrop-active"):i.classList.remove("fs-drawer-backdrop-active"))}))},e.prototype._applyBodyOpenClass=function(){this._drawerRefs.size?document.body.classList.add("fs-drawer-open"):document.body.classList.remove("fs-drawer-open")},e.prototype._storeDrawerRef=function(e){var t=this;this._drawerRefs.add(e),this._pushDrawersCascade(),e.destroy$.pipe(u.take(1),u.takeUntil(this._destroy$)).subscribe((function(){t._drawerRefs.delete(e)}))},e.prototype._pushDrawersCascade=function(){var e=this;this._drawerRefs.size>1&&setTimeout((function(){for(var t=Array.from(e._drawerRefs.values()),n=t.length-1;n>0;n--){var i=t[n-1],r=t[n];i.resizeController.pushMainWidth(r)}}))},e.prototype._createOverlay=function(){var e=this._getOverlayConfig();return this._overlay.create(e)},e.prototype._getOverlayConfig=function(){return new r.OverlayConfig({hasBackdrop:!0,backdropClass:"fs-drawer-backdrop"})},e.prototype._attachDrawerContainer=function(e,t,n){var r=this._createInjector(t,n),o=new i.ComponentPortal(M,void 0,r);return e.attach(o).instance},e.prototype._attachComponent=function(e,t,n,r){var o=this._createInjector(n,r);return t.attachComponentPortal(new i.ComponentPortal(e,void 0,o))},e.prototype._createInjector=function(e,t){var n=new WeakMap([[A,e],[F,t]]);return new i.PortalInjector(this._injector,n)},e.ctorParameters=function(){return[{type:e,decorators:[{type:t.Optional},{type:t.SkipSelf}]},{type:r.Overlay},{type:t.Injector}]},e=m([t.Injectable(),b(0,t.Optional()),b(0,t.SkipSelf()),v("design:paramtypes",[e,r.Overlay,t.Injector])],e)}(),B=function(){function e(){}return e=m([t.NgModule({imports:[n.CommonModule,c.MatTooltipModule,o.MatButtonModule,a.MatIconModule,r.OverlayModule,i.PortalModule,p.FsMenuModule,s.MatMenuModule],exports:[M,I,L,W,U],declarations:[I,M,x,T,L,W,U,j],providers:[V]})],e)}();e.DRAWER_DATA=F,e.DRAWER_MENU_DATA=D,e.DrawerData=$,e.DrawerMenuRef=P,e.DrawerRef=A,e.FsDrawerActionDirective=W,e.FsDrawerComponent=M,e.FsDrawerContentComponent=L,e.FsDrawerModule=B,e.FsDrawerResizerDirective=U,e.FsDrawerService=V,e.FsDrawerSideComponent=I,e.ɵa=E,e.ɵb=z,e.ɵc=x,e.ɵd=T,e.ɵe=j,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=firestitch-drawer.umd.min.js.map