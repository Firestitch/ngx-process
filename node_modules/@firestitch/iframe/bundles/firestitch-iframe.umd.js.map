{"version":3,"file":"firestitch-iframe.umd.js","sources":["../../src/app/functions/post-message.ts","../../src/app/directives/fs-iframe-scrollto/fs-iframe-scrollto.directive.ts","../../src/app/functions/parse-event.ts","../../src/app/directives/fs-iframe/fs-iframe.directive.ts","../../src/app/services/iframe.service.ts","../../src/app/components/iframe/iframe.component.ts","../../src/app/components/iframe/iframe.component.html","../../src/app/fs-iframe.module.ts","../../src/public_api.ts","../../src/firestitch-iframe.ts"],"sourcesContent":["export function postMessage(data) {\n  window.parent.postMessage('fs-iframe:' + JSON.stringify(data), '*');\n}\n","import { Directive, ElementRef, HostListener, OnInit, Renderer2 } from '@angular/core';\nimport { postMessage } from '../../functions/post-message';\n\n\n@Directive({\n  selector: '[fsIFrameScrollTo]'\n})\nexport class FsIFrameScrollToDirective implements OnInit {\n\n  constructor(private elementRef: ElementRef, private renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.renderer.addClass(this.elementRef.nativeElement, 'fs-iframe-scrollto');\n  }\n\n  @HostListener('click', ['$event'])\n  onClick(event) {\n    postMessage({ name: 'scrollto', value: this.elementRef.nativeElement.getBoundingClientRect().top});\n  }\n}\n","import { isString } from 'lodash-es';\n\nexport function parseEvent(event) {\n\n  if (event.data && isString(event.data)) {\n\n    const matches = event.data.match(/(fs-iframe):(.*)/);\n\n    if (matches) {\n\n      try {\n\n        return JSON.parse(matches[2]);\n\n      } catch (e) {}\n    }\n  }\n\n  return { name: null, value: null };\n}\n","import { Directive, Renderer2, ElementRef, HostListener, OnInit } from '@angular/core';\n\nimport { parseEvent } from '../../functions/parse-event';\n\n\n@Directive({\n  selector: '[fsIFrame]'\n})\nexport class FsIFrameDirective implements OnInit {\n\n  private offset = 0;\n  constructor(private elementRef: ElementRef, private renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.renderer.addClass(this.elementRef.nativeElement, 'fs-iframe');\n  }\n\n  @HostListener('window:message', ['$event'])\n  onMessage(event) {\n    const data = parseEvent(event);\n\n    if (data.name === 'height') {\n\n        const height = data.value;\n        this.renderer.setStyle(this.elementRef.nativeElement, 'height', height + 'px');\n\n    } else if (data.name === 'scrollto') {\n      window.document.documentElement.scrollTop = data.value + this.offset;\n\n    } else if (data.name === 'offset') {\n      this.offset = data.value;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { interval, Subscription } from 'rxjs';\n\nimport { postMessage } from '../functions/post-message';\n\n\n@Injectable()\nexport class FsIFrame {\n\n  private height;\n\n  observeBody(): Subscription {\n    return interval(100)\n    .subscribe(() => {\n      const height = window.document.body.offsetHeight;\n\n      if (this.height !== height) {\n        this.updateHeight(height);\n        this.height = height;\n      }\n    });\n  }\n\n  updateCurrentHeight() {\n    this.updateHeight(window.document.body.offsetHeight);\n  }\n\n  updateHeight(value) {\n    this.update('height', value);\n  }\n\n  update(name, value) {\n    postMessage({ name: name, value: value });\n  }\n}\n","import { Component, ElementRef, AfterViewInit, OnDestroy, Input, ViewChild } from '@angular/core';\n\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport { Subject, fromEvent } from 'rxjs';\n\n\n@Component({\n  selector: 'fs-iframe',\n  templateUrl: './iframe.component.html',\n  styleUrls: ['./iframe.component.scss'],\n})\nexport class FsIFrameComponent implements AfterViewInit, OnDestroy {\n\n  @ViewChild('frame')\n  public frame: ElementRef;\n\n  @Input() public html;\n  @Input() public styles;\n\n  private _destroy$ = new Subject();\n\n  public onload(): void {\n    this.updateHeight();\n  }\n\n  public get frameEl() {\n    return this.frame?.nativeElement;\n  }\n\n  public ngAfterViewInit(): void {\n    fromEvent(window, 'resize')\n      .pipe(\n        debounceTime(50),\n        takeUntil(this._destroy$)\n      )\n      .subscribe(() => {\n        this.updateHeight();\n      });\n\n    if (this.html) {\n      this._updateBodyFrames();\n    }\n  }\n\n  private _updateBodyFrames(): void {\n    const win: Window = this.frameEl.contentWindow;\n    const doc: Document = win.document;\n    const data = `\n    <style>\n      body {\n        font-family: Roboto;\n        font-size: 15px;\n        margin: 0 !important;\n        overflow-y: hidden !important;\n        width: auto !important;\n      }\n\n      a {\n        color: #1155CC;\n      }\n\n      * {\n        box-sizing: border-box !important;\n      }\n\n      ${this.styles}\n    </style>\n    ${this.html}`;\n\n    doc.open();\n    doc.write(data);\n    doc.close();\n  }\n\n\n  public ngOnDestroy(): void {\n    this._destroy$.next();\n    this._destroy$.complete();\n  }\n\n  public updateHeight(): void {\n    if (this.frameEl) {\n      this.frameEl.removeAttribute('height');\n      this.frameEl.setAttribute('height', this.frameEl.contentDocument.body.scrollHeight);\n    }\n  }\n\n}\n","<iframe #frame (load)=\"onload()\"></iframe>\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { FsIFrameScrollToDirective } from './directives/fs-iframe-scrollto/fs-iframe-scrollto.directive';\nimport { FsIFrameDirective } from './directives/fs-iframe/fs-iframe.directive';\nimport { FsIFrame } from './services/iframe.service';\nimport { FsIFrameComponent } from './../app/components/iframe/iframe.component';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n  ],\n  exports: [\n    FsIFrameScrollToDirective,\n    FsIFrameDirective,\n    FsIFrameComponent,\n  ],\n  declarations: [\n    FsIFrameScrollToDirective,\n    FsIFrameDirective,\n    FsIFrameComponent,\n  ],\n})\nexport class FsIFrameModule {\n  static forRoot(): ModuleWithProviders<FsIFrameModule> {\n    return {\n      ngModule: FsIFrameModule,\n      providers: [FsIFrame]\n    };\n  }\n}\n","// Modules\nexport { FsIFrameModule } from './app/fs-iframe.module';\n\n// Service\nexport { FsIFrame } from './app/services/iframe.service';\n\n// Components\nexport { FsIFrameComponent } from './app/components/iframe/iframe.component';\nexport { FsIFrameScrollToDirective } from './app/directives/fs-iframe-scrollto/fs-iframe-scrollto.directive';\nexport { FsIFrameDirective } from './app/directives/fs-iframe/fs-iframe.directive';\n\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i0","Directive","HostListener","isString","interval","Injectable","Subject","fromEvent","debounceTime","takeUntil","Component","ViewChild","Input","CommonModule","NgModule"],"mappings":"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"}