{"version":3,"file":"firestitch-iframe.js","sources":["../../src/app/functions/post-message.ts","../../src/app/directives/fs-iframe-scrollto/fs-iframe-scrollto.directive.ts","../../src/app/functions/parse-event.ts","../../src/app/directives/fs-iframe/fs-iframe.directive.ts","../../src/app/services/iframe.service.ts","../../src/app/components/iframe/iframe.component.ts","../../src/app/components/iframe/iframe.component.html","../../src/app/fs-iframe.module.ts","../../src/public_api.ts","../../src/firestitch-iframe.ts"],"sourcesContent":["export function postMessage(data) {\n  window.parent.postMessage('fs-iframe:' + JSON.stringify(data), '*');\n}\n","import { Directive, ElementRef, HostListener, OnInit, Renderer2 } from '@angular/core';\nimport { postMessage } from '../../functions/post-message';\n\n\n@Directive({\n  selector: '[fsIFrameScrollTo]'\n})\nexport class FsIFrameScrollToDirective implements OnInit {\n\n  constructor(private elementRef: ElementRef, private renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.renderer.addClass(this.elementRef.nativeElement, 'fs-iframe-scrollto');\n  }\n\n  @HostListener('click', ['$event'])\n  onClick(event) {\n    postMessage({ name: 'scrollto', value: this.elementRef.nativeElement.getBoundingClientRect().top});\n  }\n}\n","import { isString } from 'lodash-es';\n\nexport function parseEvent(event) {\n\n  if (event.data && isString(event.data)) {\n\n    const matches = event.data.match(/(fs-iframe):(.*)/);\n\n    if (matches) {\n\n      try {\n\n        return JSON.parse(matches[2]);\n\n      } catch (e) {}\n    }\n  }\n\n  return { name: null, value: null };\n}\n","import { Directive, Renderer2, ElementRef, HostListener, OnInit } from '@angular/core';\n\nimport { parseEvent } from '../../functions/parse-event';\n\n\n@Directive({\n  selector: '[fsIFrame]'\n})\nexport class FsIFrameDirective implements OnInit {\n\n  private offset = 0;\n  constructor(private elementRef: ElementRef, private renderer: Renderer2) {}\n\n  ngOnInit() {\n    this.renderer.addClass(this.elementRef.nativeElement, 'fs-iframe');\n  }\n\n  @HostListener('window:message', ['$event'])\n  onMessage(event) {\n    const data = parseEvent(event);\n\n    if (data.name === 'height') {\n\n        const height = data.value;\n        this.renderer.setStyle(this.elementRef.nativeElement, 'height', height + 'px');\n\n    } else if (data.name === 'scrollto') {\n      window.document.documentElement.scrollTop = data.value + this.offset;\n\n    } else if (data.name === 'offset') {\n      this.offset = data.value;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { interval, Subscription } from 'rxjs';\n\nimport { postMessage } from '../functions/post-message';\n\n\n@Injectable()\nexport class FsIFrame {\n\n  private height;\n\n  observeBody(): Subscription {\n    return interval(100)\n    .subscribe(() => {\n      const height = window.document.body.offsetHeight;\n\n      if (this.height !== height) {\n        this.updateHeight(height);\n        this.height = height;\n      }\n    });\n  }\n\n  updateCurrentHeight() {\n    this.updateHeight(window.document.body.offsetHeight);\n  }\n\n  updateHeight(value) {\n    this.update('height', value);\n  }\n\n  update(name, value) {\n    postMessage({ name: name, value: value });\n  }\n}\n","import { Component, ElementRef, AfterViewInit, OnDestroy, Input, ViewChild } from '@angular/core';\n\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport { Subject, fromEvent } from 'rxjs';\n\n\n@Component({\n  selector: 'fs-iframe',\n  templateUrl: './iframe.component.html',\n  styleUrls: ['./iframe.component.scss'],\n})\nexport class FsIFrameComponent implements AfterViewInit, OnDestroy {\n\n  @ViewChild('frame')\n  public frame: ElementRef;\n\n  @Input() public html;\n  @Input() public styles;\n\n  private _destroy$ = new Subject();\n\n  public onload(): void {\n    this.updateHeight();\n  }\n\n  public get frameEl() {\n    return this.frame?.nativeElement;\n  }\n\n  public ngAfterViewInit(): void {\n    fromEvent(window, 'resize')\n      .pipe(\n        debounceTime(50),\n        takeUntil(this._destroy$)\n      )\n      .subscribe(() => {\n        this.updateHeight();\n      });\n\n    if (this.html) {\n      this._updateBodyFrames();\n    }\n  }\n\n  private _updateBodyFrames(): void {\n    const win: Window = this.frameEl.contentWindow;\n    const doc: Document = win.document;\n    const data = `\n    <style>\n      body {\n        font-family: Roboto;\n        font-size: 15px;\n        margin: 0 !important;\n        overflow-y: hidden !important;\n        width: auto !important;\n      }\n\n      a {\n        color: #1155CC;\n      }\n\n      * {\n        box-sizing: border-box !important;\n      }\n\n      ${this.styles}\n    </style>\n    ${this.html}`;\n\n    doc.open();\n    doc.write(data);\n    doc.close();\n  }\n\n\n  public ngOnDestroy(): void {\n    this._destroy$.next();\n    this._destroy$.complete();\n  }\n\n  public updateHeight(): void {\n    if (this.frameEl) {\n      this.frameEl.removeAttribute('height');\n      this.frameEl.setAttribute('height', this.frameEl.contentDocument.body.scrollHeight);\n    }\n  }\n\n}\n","<iframe #frame (load)=\"onload()\"></iframe>\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { FsIFrameScrollToDirective } from './directives/fs-iframe-scrollto/fs-iframe-scrollto.directive';\nimport { FsIFrameDirective } from './directives/fs-iframe/fs-iframe.directive';\nimport { FsIFrame } from './services/iframe.service';\nimport { FsIFrameComponent } from './../app/components/iframe/iframe.component';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n  ],\n  exports: [\n    FsIFrameScrollToDirective,\n    FsIFrameDirective,\n    FsIFrameComponent,\n  ],\n  declarations: [\n    FsIFrameScrollToDirective,\n    FsIFrameDirective,\n    FsIFrameComponent,\n  ],\n})\nexport class FsIFrameModule {\n  static forRoot(): ModuleWithProviders<FsIFrameModule> {\n    return {\n      ngModule: FsIFrameModule,\n      providers: [FsIFrame]\n    };\n  }\n}\n","// Modules\nexport { FsIFrameModule } from './app/fs-iframe.module';\n\n// Service\nexport { FsIFrame } from './app/services/iframe.service';\n\n// Components\nexport { FsIFrameComponent } from './app/components/iframe/iframe.component';\nexport { FsIFrameScrollToDirective } from './app/directives/fs-iframe-scrollto/fs-iframe-scrollto.directive';\nexport { FsIFrameDirective } from './app/directives/fs-iframe/fs-iframe.directive';\n\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}